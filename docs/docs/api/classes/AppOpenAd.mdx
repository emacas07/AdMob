Creates [App Open Ad](https://developers.google.com/admob/android/app-open-ads) and register event listeners to various events.

Unlike other `FullScreenAd`s, only one `AppOpenAd` instance can exist in an application. Doing so, `AppOpenAd` supports static methods as well as instance methods. Calling these static methods acts same as calling instance methods for shared ad instance.

:::tip

If you are going to use App Open Ad inside _functional component_, consider using [`useAppOpenAd`](/docs/api/hooks/useAppOpenAd).

:::

## Useage Example

TODO

## Methods

### createAd()

```js
static createAd(unitId: string, options?: AppOpenAdOptions): AppOpenAd
```

Creates an shared ad instance. If you create ad more than once, ad created before is destroyed. Ad is loaded automatically after created and after dismissed.

**Parameters**

`unitId` : App Open Ad [unitId](https://support.google.com/admob/answer/7356431).

`options` (Optional) : `AppOpenAdOptions` object

Properties :

- `showOnColdStart` : Whether to show ad on app [coldstart](https://developers.google.com/admob/android/app-open-ads#coldstart). Defaults to `false`.

- `showOnAppForeground` : Whether to show ad on app becomes foreground. Defaults to `true`.

- `requestOptions` : [RequestOptions](/docs/api/types/RequestOptions) used to load the ad.

**Returns**

`AppOpenAd` instance.

### getAd()

```js
static getAd(): AppOpenAd
```

Returns created AppOpenAd shared instance.

**Returns**

`AppOpenAd` shared instance.

### load()

```js
static load(requestOptions?: RequestOptions): Promise<void>
```

Loads new App Open Ad.

Generally you don't need to call this function because ad is loaded automatically on ad created and ad dismissed.

**Parameters**

`requestOptions` (Optional) : [RequestOptions](/docs/api/types/RequestOptions) used to load the ad.

**Returns**

`Promise` that waits for ad load. When error is occured while loading ad, the Promise will reject with `AdError` object.

### show()

```js
static show(): Promise<void>
```

Shows loaded App Open Ad.

Ad must be loaded before calling this function.

You don't need to call this function if you set `showOnAppForeground` option to true.

**Returns**

`Promise` that waits for ad present. When error is occurred while presenting ad, the Promise will reject with `AdError` object.

### addEventListener()

```js
static addEventListener(event: string, handler: (event?: any) => any): void
```

Adds an event handler for an ad event.

**Parameters**

`event` : Event name. Supported events:

| Event Name        | Description                                                                                              |
| ----------------- | -------------------------------------------------------------------------------------------------------- |
| adLoaded          | Fires when the ad has finished loading.                                                                  |
| adFailedToLoad    | Fires when the ad has failed to load. The argument to the event handler is `AdError` object.             |
| adPresented       | Fires when the ad is presented to user.                                                                  |
| adFailedToPresent | Fires when an error occurred while presenting ad. The argument to the event handler is `AdError` object. |
| adDismissed       | Fires when the ad is dismissed.                                                                          |

`handler` : An event handler.

### removeAllListeners()

```js
static removeAllListeners(): void
```

Removes all registered event handlers for this ad.

### setRequestOptions()

```js
static setRequestOptions(requestOptions?: RequestOptions): void
```

Sets RequestOptions for this Ad instance.

**Parameters**

`requestOptions` : [RequestOptions](/docs/api/types/RequestOptions) used to load the ad.
